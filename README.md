# 诗成写作 (ShiCheng Writer)



**诗成写作**是一款功能强大、注重细节的桌面写作应用程序，专为作家、创作者和撰稿人设计。它提供了一个集书籍管理、章节构思、大纲设计、灵感收集和沉浸式写作为一体的综合性平台，旨在帮助您将脑海中的灵感高效地转化为文字。



## 💡 灵感来源



本项目的核心设计与功能受到了优秀的移动端写作软件 **笔落写作 (BiLuo Writer)** 的启发，并致力于在桌面端（PC）提供同样流畅、强大且专注的用户体验。



## ✨ 主要功能



- **📚 清晰的三栏式布局**:
  - **左栏**: 集成书籍与章节树状视图，使用可拖动的分割条，让您的作品目录结构一目了然。
  - **中栏**: 沉浸式文本编辑器，专注于写作本身，免受打扰。
  - **右栏**: 功能强大的选项卡式面板，集成了“素材仓库”、“灵感中心”和“时间轴”，方便随时查阅和切换，无需离开写作界面。
- **✍️ 智能编辑器**:
  - **实时统计**: 状态栏实时显示当前章节的字数统计和打字速度（字/分），让您时刻掌握写作进度。
  - **素材高亮**: 在写作时，编辑器会自动高亮您在“素材仓库”中预设的关键词（如人名、地名、设定等），确保全文设定一致性，并提供悬浮提示。
  - **格式辅助**:
    - 支持一键**全文首行缩进**和取消缩进，快速规范文本格式。
    - **回车自动缩进**：在段落后按回车键，可自动添加段首的全角空格缩进，提升写作效率。
  - **主题定制**: 内置亮色与暗色两套UI主题，支持手动切换，更能根据您操作系统的颜色方案（Dark/Light Mode）自动切换，保护您的视力。
- **💡 灵感与设定中心**:
  - **素材仓库**:
    - 集中管理您的**全局素材**（适用于所有书籍）和**本书素材**（仅用于当前书籍）。
    - 支持多种素材类型，包括**文本、对象、模板和列表**，可以构建复杂的角色卡、物品说明等结构化信息。
  - **灵感中心**:
    - **灵感锦囊**: 随时通过文本快速记录一闪而过的想法和片段，避免灵感流失。
    - **灵感仓库**: 将碎片化的灵感整理成系统性的资料库，支持树状结构管理，构建您自己的知识和创意体系。
- **📅 全新时间轴系统**:
  - 为您的书籍创建和管理多条**时间轴**，清晰地规划故事脉络和角色年表。
  - 支持无限层级的**树状事件列表**，可通过拖拽轻松调整事件顺序和层级关系。
  - 每个事件都可以详细编辑，包括**标题、时间点、状态（如未开始、进行中、已完成、关键节点）和详细内容**。
- **🔄 强大的备份与同步机制**:
  - **三层本地备份策略**，确保数据万无一失:
    - **快照线 (Snapshot)**: 分钟级高频增量备份，仅记录最近的文本修改，占用空间小。
    - **阶段点 (Stage Point)**: 在关键节点（如关闭应用、手动触发、定时任务）创建的完整备份。
    - **日终归档 (Archive)**: 每日首次启动时创建的当日完整备份，用于长期保存。
  - **WebDAV 同步**（测试中）:
    - 支持通过 WebDAV 协议将您的备份文件**同步至云端**（如坚果云、Nextcloud 等），实现跨设备的数据安全与恢复。
  - **备份管理**: 提供直观的备份管理界面，可以轻松地从过去的**本地备份或云端备份**中恢复您的数据，或删除不需要的备份文件。
  - **兼容性**: 支持读取由“笔落写作”创建的 `.bcb` 格式备份文件（部分）。
- **📤 便捷的导出功能**:
  - 支持将整本书籍（包括卷、章节和内容）导出为单个 `.txt` 文件，方便您在其他平台分享和发布。



## 🛠️ 技术栈



- **编程语言**: Python
- **图形界面**: PySide6
- **数据存储**: SQLite
- **网络同步**: Requests (用于 WebDAV 客户端)



## 📂 项目结构



```
ShiCheng_Writer/
│
├── main.py                     # 应用程序主入口
├── main_window.py              # 主窗口界面和核心逻辑
├── README.md                   # 项目说明文件
├── requirements.txt            # 项目依赖包
│
├── modules/                    # 核心功能模块
│   ├── database.py             # 数据库初始化、迁移和所有数据操作
│   ├── backup.py               # 备份与恢复管理
│   ├── theme_manager.py        # 主题（QSS）加载与管理
│   ├── material_system.py      # 素材仓库系统
│   ├── inspiration.py          # 灵感中心系统
│   ├── timeline_system.py      # 时间轴系统
│   ├── utils.py                # 通用工具函数
│   └── webdav_client.py        # 独立的 WebDAV 客户端实现
│
├── widgets/                    # 自定义UI控件
│   └── editor.py               # 自定义文本编辑器及素材高亮
│
├── backups/                    # 默认备份文件存放目录
│   └── backup_*.zip         # 备份文件示例
│
└── resources/
    ├── icons/                  # 应用图标
    └── styles/                 # QSS样式文件
        ├── style.qss           # 亮色主题
        └── dark_style.qss      # 暗色主题
```



## 🚀 如何开始



1. **环境准备**:

   - 确保您已安装 Python。
   - 建议创建一个虚拟环境来管理项目依赖。

2. **安装依赖**:

   - 项目依赖 `PySide6` 和 `requests`。您可以通过 `requirements.txt` 文件一键安装：

   Bash

   ```
   pip install -r requirements.txt
   ```

3. **运行程序**:

   Bash

   ```
   python main.py
   ```



## 📄 许可证 (License)



本软件采用 MIT 许可证。